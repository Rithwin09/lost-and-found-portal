<div class="container mt-5">
  <div *ngIf="item" class="row">
    <!-- Image Column -->
    <div class="col-md-6">
      <img [src]="'http://localhost:8080/' + item.image_url" 
           class="img-fluid rounded" 
           alt="{{ item.title }}"
           onerror="this.src='https://placehold.co/600x400?text=No+Image+Provided'">
    </div>

    <!-- Details Column -->
    <div class="col-md-6">
      <span class="badge fs-6 mb-2" [ngClass]="{'bg-success': item.status === 'found', 'bg-danger': item.status === 'lost'}">
        {{ item.status.toUpperCase() }}
      </span>
      
      <h2>{{ item.title }}</h2>
      <p>{{ item.description }}</p>

      <hr>

      <ul class="list-group list-group-flush">
        <li class="list-group-item"><strong>Category:</strong> {{ item.category }}</li>
        <li class="list-group-item"><strong>Color:</strong> {{ item.color }}</li>
        <li class="list-group-item" *ngIf="item.brand"><strong>Brand:</strong> {{ item.brand }}</li>
        <li class="list-group-item" *ngIf="item.unique_marks"><strong>Unique Marks:</strong> {{ item.unique_marks }}</li>
        <li class="list-group-item" *ngIf="item.item_size"><strong>Size:</strong> {{ item.item_size }}</li>
      </ul>

      <div class="d-grid gap-2 mt-4">
        <!-- This div now correctly uses our new, smarter 'showClaimButton' flag -->
        <div *ngIf="showClaimButton" class="d-flex align-items-center">
          <a [routerLink]="['/claim', item.id]" class="btn btn-primary">
            Claim This Item
          </a>
          <span class="ms-2" 
                data-bs-toggle="tooltip" 
                title="If you believe this item is yours, click 'Claim This Item' to begin the verification process.">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-info-circle" viewBox="0 0 16 16">
              <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
              <path d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.064.293.006.399.287.47l.45.083.082.38-2.29.287zM8 5.5a1 1 0 1 0 0-2 1 1 0 0 0 0 2z"/>
            </svg>
          </span>
        </div>
      </div>
    </div>
  </div>

  <div *ngIf="!item" class="text-center">
    <p>Loading item details...</p>
  </div>
</div>